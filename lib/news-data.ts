import { AdminStorage, type NewsArticle } from "./admin-storage"

// Статичные данные новостей для инициализации
const initialNewsData = [
  {
    id: "1",
    title: "Новые курсы обмена поврежденных долларов США",
    description:
      "Обновили тарифы на обмен поврежденных банкнот долларов США. Теперь принимаем купюры с незначительными повреждениями по еще более выгодному курсу.",
    content:
      "С 15 декабря 2024 года вступают в силу новые, более выгодные тарифы на обмен поврежденных банкнот долларов США. Мы пересмотрели критерии оценки состояния купюр и теперь можем предложить лучшие условия для наших клиентов.\n\nБанкноты с незначительными повреждениями (небольшие надрывы, потертости, загрязнения) теперь принимаются по курсу, максимально приближенному к курсу неповрежденных купюр. Это касается банкнот номиналом от $1 до $100.\n\nОценка состояния банкнот производится при клиенте с использованием профессионального оборудования. Весь процесс занимает не более 10 минут, после чего клиент получает наличные по актуальному курсу.",
    image: "/placeholder.svg?height=200&width=400",
    published: true,
    show_on_homepage: true,
    createdAt: "2024-12-15T10:00:00.000Z",
    updatedAt: "2024-12-15T10:00:00.000Z",
    contentSections: [
      {
        title: "Подробности",
        text: "С 15 декабря 2024 года вступают в силу новые, более выгодные тарифы на обмен поврежденных банкнот долларов США. Мы пересмотрели критерии оценки состояния купюр и теперь можем предложить лучшие условия для наших клиентов.\n\nБанкноты с незначительными повреждениями (небольшие надрывы, потертости, загрязнения) теперь принимаются по курсу, максимально приближенному к курсу неповрежденных купюр. Это касается банкнот номиналом от $1 до $100.\n\nОценка состояния банкнот производится при клиенте с использованием профессионального оборудования. Весь процесс занимает не более 10 минут, после чего клиент получает наличные по актуальному курсу.",
      },
    ],
    contentImage: "/placeholder.svg?height=200&width=400",
  },
  {
    id: "2",
    title: "Расширение списка принимаемых валют",
    description:
      "Добавили в список принимаемых валют швейцарские франки и японские йены. Обмениваем как новые, так и поврежденные банкноты по актуальному курсу.",
    content:
      "Рады сообщить о расширении списка принимаемых валют. Теперь мы работаем со швейцарскими франками (CHF) и японскими йенами (JPY), что делает наши услуги еще более востребованными.\n\nКурсы обмена швейцарских франков и японских йен обновляются ежедневно в соответствии с международными валютными рынками. Мы гарантируем справедливые и конкурентоспособные условия обмена.",
    image: "/placeholder.svg?height=200&width=400",
    published: true,
    show_on_homepage: true,
    createdAt: "2024-12-10T10:00:00.000Z",
    updatedAt: "2024-12-10T10:00:00.000Z",
    contentSections: [
      {
        title: "Подробности",
        text: "Рады сообщить о расширении списка принимаемых валют. Теперь мы работаем со швейцарскими франками (CHF) и японскими йенами (JPY), что делает наши услуги еще более востребованными.\n\nКурсы обмена швейцарских франков и японских йен обновляются ежедневно в соответствии с международными валютными рынками. Мы гарантируем справедливые и конкурентоспособные условия обмена.",
      },
    ],
    contentImage: "/placeholder.svg?height=200&width=400",
  },
  {
    id: "3",
    title: "Специальные условия для крупных сумм",
    description:
      "Для клиентов, обменивающих суммы от $5000, действуют особые условия и персональный подход к оценке состояния банкнот.",
    content:
      "Клиенты, обменивающие крупные суммы от $5000, получают персональное обслуживание и особые условия. Мы понимаем важность таких операций и обеспечиваем максимальный комфорт и безопасность.\n\nКаждая банкнота оценивается индивидуально с применением профессиональных методов экспертизы. Это позволяет предложить наиболее справедливую цену за каждую купюру, независимо от степени ее сохранности.",
    image: "/placeholder.svg?height=200&width=400",
    published: true,
    show_on_homepage: true,
    createdAt: "2024-12-05T10:00:00.000Z",
    updatedAt: "2024-12-05T10:00:00.000Z",
    contentSections: [
      {
        title: "Подробности",
        text: "Клиенты, обменивающие крупные суммы от $5000, получают персональное обслуживание и особые условия. Мы понимаем важность таких операций и обеспечиваем максимальный комфорт и безопасность.\n\nКаждая банкнота оценивается индивидуально с применением профессиональных методов экспертизы. Это позволяет предложить наиболее справедливую цену за каждую купюру, независимо от степени ее сохранности.",
      },
    ],
    contentImage: "/placeholder.svg?height=200&width=400",
  },
  {
    id: "4",
    title: "Обновление процедуры оценки банкнот",
    description:
      "Внедрили новое оборудование для более точной оценки состояния поврежденных банкнот, что позволяет предлагать лучшие курсы обмена.",
    content:
      "Установили современное оборудование для детальной оценки состояния банкнот. Новые ��ехнологии позволяют более точно определять степень повреждений и предлагать справедливые курсы обмена.\n\nБлагодаря новому оборудованию точность оценки повысилась на 30%, что позволяет нам предлагать более выгодные условия обмена для наших клиентов.",
    image: "/placeholder.svg?height=200&width=400",
    published: true,
    show_on_homepage: false,
    createdAt: "2024-11-28T10:00:00.000Z",
    updatedAt: "2024-11-28T10:00:00.000Z",
    contentSections: [
      {
        title: "Подробности",
        text: "Установили современное оборудование для детальной оценки состояния банкнот. Новые технологии позволяют более точно определять степень повреждений и предлагать справедливые курсы обмена.\n\nБлагодаря новому оборудованию точность оценки повысилась на 30%, что позволяет нам предлагать более выгодные условия обмена для наших клиентов.",
      },
    ],
    contentImage: "/placeholder.svg?height=200&width=400",
  },
  {
    id: "5",
    title: "Работа в праздничные дни",
    description:
      "Информируем о режиме работы в новогодние праздники. Будем принимать клиентов по предварительной записи для срочного обмена валют.",
    content:
      "В период новогодних праздников мы продолжаем работать для наших клиентов. Обслуживание ведется по предварительной записи, что гарантирует персональное внимание к каждому клиенту.\n\nДля записи на обслуживание в праздничные дни свяжитесь с нами по телефону или через WhatsApp. Мы подберем удобное время для проведения валютной операции.",
    image: "/placeholder.svg?height=200&width=400",
    published: true,
    show_on_homepage: false,
    createdAt: "2024-11-20T10:00:00.000Z",
    updatedAt: "2024-11-20T10:00:00.000Z",
    contentSections: [
      {
        title: "Подробности",
        text: "В период новогодних праздников мы продолжаем работать для наших клиентов. Обслуживание ведется по предварительной записи, что гарантирует персональное внимание к каждому клиенту.\n\nДля записи на обслуживание в праздничные дни свяжитесь с нами по телефону или через WhatsApp. Мы подберем удобное время для проведения валютной операции.",
      },
    ],
    contentImage: "/placeholder.svg?height=200&width=400",
  },
  {
    id: "6",
    title: "Безопасность валютных операций",
    description:
      "Рассказываем о мерах безопасности при обмене крупных сумм и как защитить себя от мошенников на валютном рынке.",
    content:
      "Безопасность наших клиентов - наш приоритет. Все операции проводятся в защищенном помещении с системой видеонаблюдения и сигнализации. Мы гарантируем полную конфиденциальность всех операций.\n\nРекомендуем обращаться только в лицензированные пункты обмена валют. Остерегайтесь подозрительно выгодных предложений и всегда требуйте документы, подтверждающие легальность деятельности обменного пункта.",
    image: "/placeholder.svg?height=200&width=400",
    published: true,
    show_on_homepage: false,
    createdAt: "2024-11-15T10:00:00.000Z",
    updatedAt: "2024-11-15T10:00:00.000Z",
    contentSections: [
      {
        title: "Подробности",
        text: "Безопасность наших клиентов - наш приоритет. Все операции проводятся в защищенном помещении с системой видеонаблюдения и сигнализации. Мы гарантируем полную конфиденциальность всех операций.\n\nРекомендуем обращаться только в лицензированные пункты обмена валют. Остерегайтесь подозрительно выгодных предложений и всегда требуйте документы, подтверждающие легальность деятельности обменного пункта.",
      },
    ],
    contentImage: "/placeholder.svg?height=200&width=400",
  },
]

// Функция для инициализации новостей в админ панели
export function initializeNewsData() {
  const existingNews = AdminStorage.getNewsArticles()

  // Если новостей нет, добавляем начальные данные
  if (existingNews.length === 0) {
    initialNewsData.forEach((article) => {
      AdminStorage.addNewsArticle(article as NewsArticle)
    })
  }
}

// Функция для получения всех новостей
export function getAllNews(): NewsArticle[] {
  // Инициализируем данные если их нет
  initializeNewsData()
  return AdminStorage.getNewsArticles()
}

// Функция для получения опубликованных новостей
export function getPublishedNews(): NewsArticle[] {
  return getAllNews().filter((article) => article.published)
}

// Функция для получения новостей для главной страницы
export function getHomepageNews(): NewsArticle[] {
  return getAllNews().filter((article) => article.published && article.show_on_homepage)
}

// Функция для получения новости по ID
export function getNewsById(id: string): NewsArticle | null {
  const news = getAllNews().find((article) => article.id === id)
  return news || null
}

// Функция для форматирования даты
export function formatNewsDate(dateString: string): string {
  try {
    const date = new Date(dateString)
    return date.toLocaleDateString("ru-RU", {
      year: "numeric",
      month: "long",
      day: "numeric",
    })
  } catch (error) {
    return "Дата не указана"
  }
}

// Расширенные данные для детального отображения новостей
export function getNewsWithDetails(id: string) {
  const article = getNewsById(id)
  if (!article) return null

  const contentSections =
    (article as any).contentSections && (article as any).contentSections.length > 0
      ? (article as any).contentSections
      : [
          {
            title: "Подробности",
            text: article.content,
          },
        ]

  // Добавляем дополнительные поля для совместимости с существующими компонентами
  return {
    ...article,
    date: formatNewsDate(article.createdAt),
    contentImage: (article as any).contentImage || article.image,
    contentSections,
  }
}
